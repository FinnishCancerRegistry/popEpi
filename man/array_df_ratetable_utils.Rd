% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/long_df_and_array.R
\name{array_df_ratetable_utils}
\alias{array_df_ratetable_utils}
\alias{array_to_long_df}
\alias{array_to_long_dt}
\alias{long_df_to_array}
\alias{long_dt_to_array}
\alias{array_to_ratetable}
\alias{ratetable_to_array}
\title{\code{array}s, \code{data.frame}s and \code{ratetable}s}
\usage{
array_to_long_df(x)

array_to_long_dt(x)

long_df_to_array(x, stratum.col.nms, value.col.nm)

long_dt_to_array(x, stratum.col.nms, value.col.nm)

array_to_ratetable(x, dim.types, cut.points = NULL)

ratetable_to_array(x)
}
\arguments{
\item{x}{(mandatory, no default)
\itemize{
\item \code{array_to_long_df}: an \code{array}
\item \code{long_df_to_array}: a \code{data.frame}
\item \code{array_to_ratetable}: an \code{array}
\item \code{ratetable_to_array}: a \link[survival:ratetable]{survival::ratetable}
}}

\item{stratum.col.nms}{`[character]` (mandatory, no default)

a vector of column names in `x` by which values are stratified}

\item{value.col.nm}{`[character]` (mandatory, no default)

name of column in `x` containing values (these will be contents of the
array)}

\item{dim.types}{`[integer]` (mandatory, no default)

see `type` under **Details** in [survival::ratetable]}

\item{cut.points}{`[NULL, list]` (optional, default `NULL`)

see `cutpoints` under **Details** in [survival::ratetable] 

- `NULL`: automatically set using `dimnames(x)` and `dim.types`
- `list`: one element for each dimensions of `x`}
}
\description{
Utilities to transform objects between \code{array}, \code{data.frame}, and
\link[survival:ratetable]{survival::ratetable}.
}
\details{
\itemize{
\item \code{array_to_long_df}: converts an array with one or more dimensions into
a long-format \code{data.frame}; any \link{dimnames} are used to name and fill the
stratifying columns; for dimensions without a name, \code{".dX"} is used
for the \code{X}th stratifying column; for each \code{k}, if there are no contents
in \code{dimnames(x)[[k]]}, the elements of \code{seq(dim(x)[k])} are used to fill
the corresponding stratifying column; the value column always has the name
\code{"value"}
}

- `array_to_long_dt`: calls `array_to_long_df` and converts result to a 
  `data.table` for convenience

- `long_df_to_array`: converts a long-format `data.frame` to an `array`
  with one or more dimensions

- `long_dt_to_array`: simply asserts that `x` is a `data.table` and 
calls `long_df_to_array`

- `array_to_ratetable`: converts an array to a [survival::ratetable]

- `ratetable_to_array`: converts a [survival::ratetable] to an array
}
\examples{

long_dt <- popEpi::popmort
arr <- long_df_to_array(long_dt, c("agegroup", "year", "sex"), "haz") 
rt <- array_to_ratetable(arr, dim.types = c(2L, 4L, 1L))

arr2 <- ratetable_to_array(rt)
long_df2 <- array_to_long_df(arr2)

identical(sort(long_dt[["haz"]]), sort(long_df2[["value"]]))

}
