% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/incidence_rates.R
\name{rate}
\alias{rate}
\title{Direct-Standardised Incidence/Mortality Rates}
\usage{
rate(data, obs = NULL, pyrs = NULL, print = NULL, adjust = NULL,
  weights = NULL, subset = NULL)
}
\arguments{
\item{data}{aggregated data (see e.g. \code{\link{lexpand}}, 
\code{\link{aggre}} if you have subject-level data)}

\item{obs}{observations variable name in data.}

\item{pyrs}{person-years variable name in data.}

\item{print}{variable name to stratify the rates. Vector or a list. Functions
can be in list, \code{list( year.cat := cut(year, c(1990,2000,2010)) )}}

\item{adjust}{variable for adjusting the rates.}

\item{weights}{typically a list of weights or a \code{character} string
specifying an age group standardization scheme; see
the \link[=direct_standardization]{dedicated help page} 
and examples.}

\item{subset}{a logical expression to subset data.}
}
\value{
Returns a \code{data.table} with observations, person-years, rates and
adjusted rates, if availble. Results are stratified by \code{print}.
Adjusted rates are identified with suffix \code{.adj} and  
\code{.lo} and \code{.hi} are for confidence intervals lower and upper 
95\% bounds, respectively.
The prefix \code{SE.} stands for standard error.
}
\description{
\code{rate} calculates adjusted rates using
preloaded weights data or user specified weights.
}
\details{
Input data needs to be in aggregated format with observations 
and person-years. For individual data use \code{\link{lexpand}}, or
\code{\link{ltable}} and merge person-years manually.
}
\examples{
## Prepare data with lexpand and then reformat agegroup.
data(sibr)
x <- lexpand(sibr, birth = bi_date, entry = dg_date, exit = ex_date,  
             breaks = list(per = c(1990,2000,2010,2020), age = c(0:17*5,Inf)),
             aggre = list(agegroup = age, year.cat = per),
             status =  status != 0)

x$agegroup <- cut(x$agegroup,  c(0:17*5,Inf), right = FALSE)

## calculate rates for selected periods with Nordic 2000 weights:
r1 <- rate( data = x, obs = from0to1, pyrs = pyrs, print = year.cat, 
            adjust = agegroup, weights = 'nordic')
r1

r2 <- rate( data = x, obs = from0to1, pyrs = pyrs, print = year.cat, 
            adjust = agegroup,
            weights = list( agegroup = c(4,5,5,5,5,4,4,3,3,2,2,1,1) ))
r2

r3 <- rate( data = x, obs = from0to1, pyrs = pyrs, print = year.cat, 
            adjust = agegroup,
            weights = "internal")
r3

}
\author{
Matti Rantanen, Joonas Miettinen
}
\seealso{
\code{\link{lexpand}}, \code{\link{ltable}}
}

