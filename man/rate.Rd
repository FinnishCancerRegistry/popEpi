% Generated by roxygen2 (4.1.1): do not edit by hand
% Please edit documentation in R/incidence_rates.R
\name{rate}
\alias{rate}
\title{Standardised incidence/mortality rates (direct method)}
\usage{
rate(data, obs, pyrs, print = NULL, adjust = NULL, weights = NULL,
  weight.data = "world66_5", subset = NULL)
}
\arguments{
\item{data}{aggregated data (see: \code{\link{lexband}})}

\item{obs}{observations variable name in data, quoted or unquoted.}

\item{pyrs}{person-years variable name in data, quoted or unquoted}

\item{print}{variable name to stratify the rates. Vector or a list. Functions
can be in list, \code{list( year.cat := cut(year, c(1990,2000,2010)) )}}

\item{adjust}{variable for adjusting the rates, quoted or unquoted}

\item{weights}{user defined weights in a list. length of the list should
equal to variable levels in \code{adjust}. See examples.  (currenty only one dimension supported)}

\item{weight.data}{character string; select standard population:
\code{'nordic', 'world66_5','europe', 'world00_1', 'world00_18of5', 'world00_20of5'} or \code{'cohort'}
If NULL, the weights are fetched from \code{weights}.}

\item{subset}{a logical expression to subset data.}
}
\value{
Returns a \code{data.table} with observations, person-years, rates and
adjusted rates, if availble. Results are stratified by \code{print}.
Adjusted rates are identified with suffix \code{.adj} and
\code{.lo} and \code{.hi} are for confidence intervals lower and upper
95\% bounds, respectively.
The prefix \code{SE.} stands for standard error.
}
\description{
\code{rate} calculates adjusted rates using
preloaded weights data or user specified weights.
}
\details{
Input data needs to be in aggregated format with observations
and person-years. For individual data use \code{\link{lexband}}. Or
\code{\link{ltable}} and merge person-years manually.

\strong{Weights}

User can set weights in a named list. These weights are merged with unique
levels of variable in \code{adjust}. \strong{Multiple weights support coming soon.}

\strong{Standard populations}

Rates can be standardized either by preloaded standard
population or cohorts person-years. For the world standard population,
four possibilities are currently available:
The old world standard population from 1966 (\code{'world66_5'}),
the new equivalent from 2000 with 18 or 20 age groups
 (\code{'world00_18of5'} or \code{'world00_20of5'})
and the 1-year age groups (\code{'world00_1'}).

Differences between rates using the old and new population standards will
arise due to the shift in world population - the proportion of young people
has fallen. The new standard is arguably more useful when interpretability
and generalizability are concerned. However, the old standard is used still
in many contexts in order to assure comparability with old results.

Available age group standardization options:
\itemize{
\item 'europe' - european std. popupulation, 18 age groups
\item 'nordic' - nordic std. popupulation, 18 age groups
\item 'world66_5' - world 1966 standard, 18 age groups
\item 'world00_18of5' - world 2000 standard, 18 agegroups
\item 'world00_20of5' - world 2000 standard, 20 agegroups
\item 'world00_1' - world 2000 standard, 101 agegroups
\item 'cohort' - weights are calculated from cohort person-years. Same
age specific weights are applied for each stratum, i.e. weights are
aggreagated from the whole cohort.
}

Age groups are coded in integer values 1-18, 1-20 and 1-101. Data is
derived from datasets included in \pkg{popEpi}: \code{\link{stdpop18}} and
\code{\link{stdpop101}}.

Note that age group variable should naturally have a correct number of
levels for the rate you want to calculate.
}
\examples{
## Prepare data with lexband and then reformat agegroup.
x <- lexpand(sibr, birth = bi_date, entry = dg_date, exit = ex_date,
             breaks = list(per = c(1990,2000,2010,2020), age = c(0:17*5,Inf)),
             aggre = list(agegroup = age, year.cat = per),
             status =  status != 0)

x$agegroup <- findInterval(x$agegroup,  c(0:17*5,Inf))

## calculate rates for selected periods with Nordic 2000 weights:
r1 <- rate( data = x, obs = from0to1, pyrs = pyrs, print = year.cat,
            adjust = agegroup, weight.data = 'nordic')
r1

r2 <- rate( data = x, obs = from0to1, pyrs = pyrs, print = year.cat,
            adjust = agegroup, weight.data = NULL,
            weights = list( agegroup = c(4,5,5,5,5,4,4,3,3,2,2,1,1) ))
r2
}
\author{
Matti Rantanen, Joonas Miettinen
}
\references{
Source of the Nordic standard population in 5-year age groups (also contains European & 1966 world standards):
\url{http://www-dep.iarc.fr/NORDCAN/english/glossary.htm}

A discussion (and source) of the old European standard population:
\url{http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-RA-13-028/EN/KS-RA-13-028-EN.PDF}

A comparison of the 1966 vs. 2000 world standard populations in 5-year age groups:
\url{http://www3.ha.org.hk/cancereg/e_asr.asp}

Source of 2000 world standard population in 1-year age groups:
\url{http://seer.cancer.gov/stdpopulations/stdpop.singleages.html}
}
\seealso{
\code{\link{lexpand}}, \code{\link{ltable}}
}

